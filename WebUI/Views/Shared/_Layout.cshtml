@using LOGA.WebUI.Models
@using LOGA.WebUI
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title - "Ⴁⴄⴁⴍ Ⴄⴌⴀ" ვისწავლოთ ხუცური</title>
    <link href="~/Content/Site.css" rel="stylesheet" type="text/css" />
    <link href="~/Content/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <script src="~/Scripts/jquery-2.2.2.min.js"></script> <!-- must appear before bootstrap.js -->
    <script src="~/Scripts/jquery.unobtrusive-ajax.min.js"></script>
    <script src="~/Scripts/bootstrap.min.js"></script>
    <script src="~/Scripts/modernizr-2.6.2.js"></script>

    <!-- TODO: Scripts.Render("~/bundles/jquery") -->
</head>
<body>

    <script>
        $(document).ready(function () {
            $('[data-toggle="tooltip"]').tooltip();
        });
    </script>

    <script>
        $(function () {
            $("#default-focus-a").focus();
        });
    </script>

    <script>
        function onBegin() {
            $('#btnSaveUserSettings').addClass('disabled');
        }

        function onSuccess(data) {
            if (data.HasDisplayName) {
                $('#spanUserAnonymous').addClass('hide');
                $('#spanUserNamed').removeClass('hide');
            }
            else {
                $('#spanUserAnonymous').removeClass('hide');
                $('#spanUserNamed').addClass('hide');
            }
            $('#spanUserDisplayName').text(data.DisplayName);

            $('#modalUserSettings').modal('hide');
            $('#btnSaveUserSettings').removeClass('disabled');
        }
    </script>

    @if (Html.IsDebugMode())
    {
        <p class="bg-warning text-center">
            <br />
            DEBUG MODE @DateTime.Now.ToString()
            <br />
            <br />
        </p>
    }

    @if (Html.IsDebugMode())
    {
        <p>
            <button type="button" data-toggle="modal" data-target="#modalUserSettings" autofocus="">Show settings modal</button>
        </p>
    }

    <div id="modalUserSettings" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modal-large">

        @using (Ajax.BeginForm(new AjaxOptions { Url = "/Home/UpdateSettings", UpdateTargetId = "", OnBegin = "onBegin", OnSuccess = "onSuccess", LoadingElementId = "lblSaveInProgress", LoadingElementDuration = 500 }))
        {
            @Html.Partial("UserSettingsPartial", HttpContextStorage.GetUserSettings(Context))
        }
    </div>

    <div class="navbar navbar-default">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                @Html.ActionLink("Ⴁⴄⴁⴍ Ⴄⴌⴀ", "Index", "Home", null, new { @class = "navbar-brand" })
            </div>
            <div id="navbar" class="collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li class="@(ViewData["ActiveMenu"].ToString() == "Learn" ? "active" : "")"><a href="@Url.Action("Index", "Learn")">სწავლა</a></li>
                    <li class="@(ViewData["ActiveMenu"].ToString() == "_Learn_" ? "active" : "")"><a href="@Url.Action("Index", "_Learn_")">სავარჯიშოები</a></li>
                    <li class="@(ViewData["ActiveMenu"].ToString() == "Downloads" ? "active" : "")"><a href="@Url.Action("Index", "Downloads")">სასარგებლო მასალები</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#" data-toggle="modal" data-target="#modalUserSettings">
                            @{
                                var userDisplayName = HttpContextStorage.GetUserSettings(Context).DisplayName;
                                var userHasDisplayName = !String.IsNullOrWhiteSpace(userDisplayName);
                            }
                            <span class="glyphicon glyphicon-user"></span>
                            <span class="@(userHasDisplayName ? "hide" : "")" id="spanUserAnonymous" data-toggle="tooltip" title="მიუთითეთ სწავლის პარამეტრები">პარამეტრები</span>
                            <span class="@(userHasDisplayName ? "" : "hide")" id="spanUserNamed" data-toggle="tooltip" title="თქვენი სწავლის პარამეტრები">მოგესალმებით, <span id="spanUserDisplayName">@userDisplayName</span>!</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div class="container body-content">
        @RenderBody()
        <hr />
        <footer style="color: gray">
            <p>&copy; @DateTime.Now.Year "ბებო ენა" :) - ვისწავლოთ ხუცური</p>
            <p>საკონტაქტო ელ-ფოსტა: <a href="mailto:khubua@gmail.com">khubua@gmail.com</a></p>
        </footer>
    </div>

</body>
</html>